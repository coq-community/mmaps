<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./../..">Project Website</a>
      <a href="./indexpage.html">Index</a>
      <a href="./toc.html">Table of Contents</a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<div class="code">
</div>

<div class="doc">
<a id="lab145"></a><h1 class="section">Finite Modular Maps: The Demo</h1>

<div class="paragraph"> </div>

 Author: Pierre Letouzey (Université de Paris - INRIA),
    adapted from earlier works in Coq Standard Library, see README.md.
    License: LGPL-2.1-only, see file LICENSE. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Strings.String.html#"><span class="id" title="library">String</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.Orders.html#"><span class="id" title="library">Orders</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">MMaps</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="MMaps.MMaps.html#"><span class="id" title="library">MMaps</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>

<br/>
</div>

<div class="doc">
This MMaps library provides finite maps (e.g. key/value structure).
    It is an improved version of the former FMaps library, which is
    itself derived from the OCaml Map library.
    The "M" in the current name is for Module (and to be different
    from FMaps), nothing to see with the unix system call "mmap". 
<div class="paragraph"> </div>

 In these maps, we associate keys to values.
    The key type is rigidly fixed at the creation of the module
    (usually by giving an OrderedType module to the creating functor).
    while the value type is polymorphic and may vary from map to map,
    even in the same MMaps instance. 
<div class="paragraph"> </div>

 The OrderedType notion is the one of Coq Stdlib,
    already used in <span class="inlinecode"><span class="id" title="var">MSets</span></span>. The main function is <span class="inlinecode"><a class="idref" href="MMaps.GenTree.html#Ops.compare"><span class="id" title="definition">compare</span></a></span>,
    which has a ternary <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#comparison"><span class="id" title="inductive">comparison</span></a></span> output, and is specified
    w.r.t. an equivalence <span class="inlinecode"><a class="idref" href="MMaps.Facts.html#OrderedMaps.eq"><span class="id" title="definition">eq</span></a></span> and a strict order <span class="inlinecode"><a class="idref" href="MMaps.Facts.html#OrderedMaps.lt"><span class="id" title="definition">lt</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">Orders.OrderedType</span>.<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">comparison</span>.<br/>
<span class="id" title="keyword">Print</span> <span class="id" title="var">CompareSpec</span>.<br/>

<br/>
</div>

<div class="doc">
Many datatype modules of Coq are already implementing OrderedType.
    For instance, let's build some maps with <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a></span> numbers as keys,
    and then maps with <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a></span> numbers as keys. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a id="NatMaps" class="idref" href="#NatMaps"><span class="id" title="module">NatMaps</span></a> := <a class="idref" href="MMaps.RBT.html#Make"><span class="id" title="module">MMaps.RBT.Make</span></a>(<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Arith.PeanoNat.html#Nat"><span class="id" title="module">Nat</span></a>).<br/>
<span class="id" title="keyword">Module</span> <a id="ZM" class="idref" href="#ZM"><span class="id" title="module">ZM</span></a> := <a class="idref" href="MMaps.RBT.html#Make"><span class="id" title="module">MMaps.RBT.Make</span></a>(<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z"><span class="id" title="module">BinInt.Z</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Let's&nbsp;play&nbsp;with&nbsp;them&nbsp;:&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="map1" class="idref" href="#map1"><span class="id" title="definition">map1</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> 3 "yes" (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> 0 "no" (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> 2 "foo" <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">ZM.empty</span></a>)).<br/>
<span class="id" title="keyword">Definition</span> <a id="map2" class="idref" href="#map2"><span class="id" title="definition">map2</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> 3 <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>2<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> 0 <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>3<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>4<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>5<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> 7 <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">ZM.empty</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#find"><span class="id" title="definition">ZM.find</span></a> 3 <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a>.<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#find"><span class="id" title="definition">ZM.find</span></a> 3 <a class="idref" href="MMaps.demo.html#map2"><span class="id" title="definition">map2</span></a>.<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">ZM.bindings</span></a> <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a>.<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">ZM.bindings</span></a> (<a class="idref" href="MMaps.demo.html#remove"><span class="id" title="definition">ZM.remove</span></a> 0 <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Some&nbsp;examples&nbsp;of&nbsp;more&nbsp;advanced&nbsp;operations&nbsp;:&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#fold"><span class="id" title="definition">ZM.fold</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Strings.String.html#append"><span class="id" title="definition">String.append</span></a>) <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a> "".<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">ZM.bindings</span></a> (<a class="idref" href="MMaps.demo.html#map"><span class="id" title="definition">ZM.map</span></a> (@<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) <a class="idref" href="MMaps.demo.html#map2"><span class="id" title="definition">map2</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="reconciliate" class="idref" href="#reconciliate"><span class="id" title="definition">reconciliate</span></a>(<a id="z:1" class="idref" href="#z:1"><span class="id" title="binder">z</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)(<a id="o:2" class="idref" href="#o:2"><span class="id" title="binder">o</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>)(<a id="o':3" class="idref" href="#o':3"><span class="id" title="binder">o'</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)) :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MMaps.demo.html#o:2"><span class="id" title="variable">o</span></a>,<a class="idref" href="MMaps.demo.html#o':3"><span class="id" title="variable">o'</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> "new" | <span class="id" title="var">_</span>,<span class="id" title="var">_</span> ⇒ <a class="idref" href="MMaps.demo.html#o:2"><span class="id" title="variable">o</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="map3" class="idref" href="#map3"><span class="id" title="definition">map3</span></a> := <a class="idref" href="MMaps.demo.html#merge"><span class="id" title="definition">ZM.merge</span></a> <a class="idref" href="MMaps.demo.html#reconciliate"><span class="id" title="definition">reconciliate</span></a> <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a> <a class="idref" href="MMaps.demo.html#map2"><span class="id" title="definition">map2</span></a>.<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">ZM.bindings</span></a> <a class="idref" href="MMaps.demo.html#map3"><span class="id" title="definition">map3</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;ZM&nbsp;also&nbsp;provides&nbsp;some&nbsp;basic&nbsp;properties,&nbsp;for&nbsp;instance:&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="MMaps.demo.html#cardinal_spec"><span class="id" title="lemma">ZM.cardinal_spec</span></a> <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a>).<br/>
<span class="comment">(*&nbsp;The&nbsp;number&nbsp;of&nbsp;bindings&nbsp;in&nbsp;<span class="inlinecode"><span class="id" title="var">map1</span></span>&nbsp;is&nbsp;the&nbsp;length&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">bindings</span></span> <span class="inlinecode"><span class="id" title="var">map1</span></span>.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="MMaps.demo.html#bindings_spec2"><span class="id" title="lemma">ZM.bindings_spec2</span></a> <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a>).<br/>
<span class="comment">(*&nbsp;bindings&nbsp;always&nbsp;returns&nbsp;a&nbsp;sorted&nbsp;list<br/>
&nbsp;&nbsp;&nbsp;with&nbsp;respect&nbsp;to&nbsp;the&nbsp;underlying&nbsp;order&nbsp;on&nbsp;keys.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;ZM.t&nbsp;type&nbsp;for&nbsp;maps&nbsp;is&nbsp;meant&nbsp;to&nbsp;be&nbsp;used&nbsp;as&nbsp;an&nbsp;abstract&nbsp;type<br/>
&nbsp;&nbsp;&nbsp;since&nbsp;it&nbsp;will&nbsp;vary&nbsp;among&nbsp;the&nbsp;different&nbsp;implementations&nbsp;of&nbsp;MMaps.<br/>
&nbsp;&nbsp;&nbsp;An&nbsp;ZM.t&nbsp;can&nbsp;and&nbsp;should&nbsp;always&nbsp;be&nbsp;inspected&nbsp;by&nbsp;using&nbsp;<span class="inlinecode"><span class="id" title="var">find</span></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">bindings</span></span>,&nbsp;etc.<br/>
&nbsp;&nbsp;&nbsp;But&nbsp;for&nbsp;once,&nbsp;let's&nbsp;have&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;raw&nbsp;aspect&nbsp;of&nbsp;a&nbsp;map:&nbsp;*)</span><br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#map1"><span class="id" title="definition">map1</span></a>.<br/>
<span class="comment">(*&nbsp;Here&nbsp;for&nbsp;RBT&nbsp;(Red-Black-Tree),&nbsp;a&nbsp;map&nbsp;is&nbsp;a&nbsp;record&nbsp;combining<br/>
&nbsp;&nbsp;&nbsp;a&nbsp;tree&nbsp;(field&nbsp;ZM.this)&nbsp;and&nbsp;a&nbsp;proof&nbsp;(field&nbsp;ZM.ok).&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Note&nbsp;that&nbsp;the&nbsp;proof&nbsp;part&nbsp;will&nbsp;grow&nbsp;at&nbsp;each&nbsp;operation&nbsp;of&nbsp;the&nbsp;map.<br/>
&nbsp;&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;avoid&nbsp;that,&nbsp;we&nbsp;can&nbsp;work&nbsp;on&nbsp;the&nbsp;underlying&nbsp;"raw"<br/>
&nbsp;&nbsp;&nbsp;datatype&nbsp;(i.e.&nbsp;without&nbsp;built-in&nbsp;invariants).&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="R" class="idref" href="#R"><span class="id" title="module">R</span></a>:=<a class="idref" href="MMaps.demo.html#ZM.Raw"><span class="id" title="module">ZM.Raw</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="raw1" class="idref" href="#raw1"><span class="id" title="definition">raw1</span></a> := <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">R.add</span></a> 3 "yes" (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">R.add</span></a> 0 "no" (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">R.add</span></a> 2 "foo" (<a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">R.empty</span></a> <span class="id" title="var">_</span>))).<br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#raw1"><span class="id" title="definition">raw1</span></a>.<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">R.bindings</span></a> <a class="idref" href="MMaps.demo.html#raw1"><span class="id" title="definition">raw1</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;But&nbsp;then&nbsp;proving&nbsp;properties&nbsp;is&nbsp;a&nbsp;bit&nbsp;more&nbsp;complex.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Check</span> (@<a class="idref" href="MMaps.demo.html#bindings_spec2"><span class="id" title="lemma">R.bindings_spec2</span></a> <span class="id" title="var">_</span> <a class="idref" href="MMaps.demo.html#raw1"><span class="id" title="definition">raw1</span></a> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="comment">(*&nbsp;The&nbsp;second&nbsp;"_"&nbsp;is&nbsp;a&nbsp;proof&nbsp;that&nbsp;raw1&nbsp;is&nbsp;"Ok".&nbsp;Fortunately,&nbsp;the&nbsp;system<br/>
&nbsp;&nbsp;&nbsp;has&nbsp;infered&nbsp;it&nbsp;here&nbsp;via&nbsp;some&nbsp;class&nbsp;resolution,&nbsp;and&nbsp;it&nbsp;should&nbsp;be<br/>
&nbsp;&nbsp;&nbsp;the&nbsp;case&nbsp;when&nbsp;using&nbsp;the&nbsp;provided&nbsp;operations.&nbsp;If&nbsp;you&nbsp;have&nbsp;built<br/>
&nbsp;&nbsp;&nbsp;your&nbsp;own&nbsp;map&nbsp;without&nbsp;using&nbsp;the&nbsp;provided&nbsp;operations,&nbsp;you&nbsp;could<br/>
&nbsp;&nbsp;&nbsp;consider&nbsp;the&nbsp;"isok"&nbsp;boolean&nbsp;function&nbsp;to&nbsp;check&nbsp;it,&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">Mkt_bool</span></span><br/>
&nbsp;&nbsp;&nbsp;to&nbsp;"repack"&nbsp;it&nbsp;into&nbsp;a&nbsp;map&nbsp;with&nbsp;correctness&nbsp;proof.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#isok"><span class="id" title="definition">R.isok</span></a> <a class="idref" href="MMaps.demo.html#raw1"><span class="id" title="definition">raw1</span></a>.<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> : <a class="idref" href="MMaps.demo.html#isok"><span class="id" title="definition">R.isok</span></a> <a class="idref" href="MMaps.demo.html#raw1"><span class="id" title="definition">raw1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>).<br/>
<span class="id" title="keyword">Check</span> (@<a class="idref" href="MMaps.demo.html#Mkt_bool"><span class="id" title="definition">ZM.Mkt_bool</span></a> <span class="id" title="var">_</span> <a class="idref" href="MMaps.demo.html#raw1"><span class="id" title="definition">raw1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab146"></a><h2 class="section">Some more intense tests</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="multiples" class="idref" href="#multiples"><span class="id" title="definition">multiples</span></a> (<a id="m:6" class="idref" href="#m:6"><span class="id" title="binder">m</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)(<a id="start:7" class="idref" href="#start:7"><span class="id" title="binder">start</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)(<a id="n:8" class="idref" href="#n:8"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">n</span>} : <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MMaps.demo.html#n:8"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n</span> ⇒ <a class="idref" href="MMaps.demo.html#start:7"><span class="id" title="variable">start</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::(</span></a><a class="idref" href="MMaps.demo.html#multiples:9"><span class="id" title="definition">multiples</span></a> <a class="idref" href="MMaps.demo.html#m:6"><span class="id" title="variable">m</span></a> (<a class="idref" href="MMaps.demo.html#m:6"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a><a class="idref" href="MMaps.demo.html#start:7"><span class="id" title="variable">start</span></a>) <a class="idref" href="MMaps.demo.html#n:8"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> (<a class="idref" href="MMaps.demo.html#multiples"><span class="id" title="definition">multiples</span></a> 2 0 200%<span class="id" title="var">nat</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="bigmap1" class="idref" href="#bigmap1"><span class="id" title="definition">bigmap1</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> (<span class="id" title="keyword">fun</span> <a id="z:11" class="idref" href="#z:11"><span class="id" title="binder">z</span></a> ⇒ <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> <a class="idref" href="MMaps.demo.html#z:11"><span class="id" title="variable">z</span></a> <a class="idref" href="MMaps.demo.html#z:11"><span class="id" title="variable">z</span></a>) <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">ZM.empty</span></a> (<a class="idref" href="MMaps.demo.html#multiples"><span class="id" title="definition">multiples</span></a> 2 0 400%<span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Definition</span> <a id="bigmap2" class="idref" href="#bigmap2"><span class="id" title="definition">bigmap2</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> (<span class="id" title="keyword">fun</span> <a id="z:12" class="idref" href="#z:12"><span class="id" title="binder">z</span></a> ⇒ <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> <a class="idref" href="MMaps.demo.html#z:12"><span class="id" title="variable">z</span></a> <a class="idref" href="MMaps.demo.html#z:12"><span class="id" title="variable">z</span></a>) <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">ZM.empty</span></a> (<a class="idref" href="MMaps.demo.html#multiples"><span class="id" title="definition">multiples</span></a> 3 0 400%<span class="id" title="var">nat</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="both" class="idref" href="#both"><span class="id" title="definition">both</span></a> (<a id="z:13" class="idref" href="#z:13"><span class="id" title="binder">z</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)(<a id="o:14" class="idref" href="#o:14"><span class="id" title="binder">o</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>)(<a id="o':15" class="idref" href="#o':15"><span class="id" title="binder">o'</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MMaps.demo.html#o:14"><span class="id" title="variable">o</span></a>,<a class="idref" href="MMaps.demo.html#o':15"><span class="id" title="variable">o'</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span>, <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="MMaps.demo.html#o:14"><span class="id" title="variable">o</span></a> | <span class="id" title="var">_</span>,<span class="id" title="var">_</span>⇒<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Time</span> <span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">ZM.bindings</span></a> (<a class="idref" href="MMaps.demo.html#merge"><span class="id" title="definition">ZM.merge</span></a> <a class="idref" href="MMaps.demo.html#both"><span class="id" title="definition">both</span></a> <a class="idref" href="MMaps.demo.html#bigmap1"><span class="id" title="definition">bigmap1</span></a> <a class="idref" href="MMaps.demo.html#bigmap2"><span class="id" title="definition">bigmap2</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="bigmap3" class="idref" href="#bigmap3"><span class="id" title="definition">bigmap3</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> (<span class="id" title="keyword">fun</span> <a id="z:18" class="idref" href="#z:18"><span class="id" title="binder">z</span></a> ⇒ <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> <a class="idref" href="MMaps.demo.html#z:18"><span class="id" title="variable">z</span></a> <a class="idref" href="MMaps.demo.html#z:18"><span class="id" title="variable">z</span></a>) <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">ZM.empty</span></a> (<a class="idref" href="MMaps.demo.html#multiples"><span class="id" title="definition">multiples</span></a> 2 0 (100<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a>100)%<span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Definition</span> <a id="bigmap4" class="idref" href="#bigmap4"><span class="id" title="definition">bigmap4</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Lists.List.html#fold_right"><span class="id" title="definition">fold_right</span></a> (<span class="id" title="keyword">fun</span> <a id="z:19" class="idref" href="#z:19"><span class="id" title="binder">z</span></a> ⇒ <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> <a class="idref" href="MMaps.demo.html#z:19"><span class="id" title="variable">z</span></a> <a class="idref" href="MMaps.demo.html#z:19"><span class="id" title="variable">z</span></a>) <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">ZM.empty</span></a> (<a class="idref" href="MMaps.demo.html#multiples"><span class="id" title="definition">multiples</span></a> 3 0 (100<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a>100)%<span class="id" title="var">nat</span>).<br/>
<span class="id" title="keyword">Time</span> <span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">ZM.bindings</span></a> (<a class="idref" href="MMaps.demo.html#merge"><span class="id" title="definition">ZM.merge</span></a> <a class="idref" href="MMaps.demo.html#both"><span class="id" title="definition">both</span></a> <a class="idref" href="MMaps.demo.html#bigmap3"><span class="id" title="definition">bigmap3</span></a> <a class="idref" href="MMaps.demo.html#bigmap4"><span class="id" title="definition">bigmap4</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab147"></a><h2 class="section">The Facts</h2>

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;The&nbsp;properties&nbsp;provided&nbsp;by&nbsp;ZM&nbsp;are&nbsp;deliberately&nbsp;minimalistic.<br/>
&nbsp;&nbsp;&nbsp;They&nbsp;correspond&nbsp;to&nbsp;the&nbsp;minimal&nbsp;specifications&nbsp;present&nbsp;in&nbsp;Interface.S.<br/>
&nbsp;&nbsp;&nbsp;This&nbsp;way,&nbsp;building&nbsp;new&nbsp;implementations&nbsp;is&nbsp;relatively&nbsp;simple.<br/>
&nbsp;&nbsp;&nbsp;Now,&nbsp;lots&nbsp;of&nbsp;additional&nbsp;facts&nbsp;can&nbsp;be&nbsp;derived&nbsp;from&nbsp;this&nbsp;common&nbsp;interface.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="ZMF" class="idref" href="#ZMF"><span class="id" title="module">ZMF</span></a> := <a class="idref" href="MMaps.Facts.html#Properties"><span class="id" title="module">MMaps.Facts.Properties</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z"><span class="id" title="module">BinInt.Z</span></a> <a class="idref" href="MMaps.demo.html#ZM"><span class="id" title="module">ZM</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;It&nbsp;contains&nbsp;mainly&nbsp;rephrasing&nbsp;of&nbsp;the&nbsp;specifications.&nbsp;*)</span><br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MMaps.demo.html#add_1"><span class="id" title="lemma">ZMF.add_1</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MMaps.demo.html#add_b"><span class="id" title="lemma">ZMF.add_b</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;And&nbsp;some&nbsp;basic&nbsp;things&nbsp;about&nbsp;the&nbsp;operations.&nbsp;*)</span><br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MMaps.demo.html#cardinal_notin_add"><span class="id" title="lemma">ZMF.cardinal_notin_add</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Also&nbsp;useful:&nbsp;induction&nbsp;principles&nbsp;*)</span><br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MMaps.demo.html#map_induction"><span class="id" title="lemma">ZMF.map_induction</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;And&nbsp;lot&nbsp;of&nbsp;stuff&nbsp;concerning&nbsp;the&nbsp;hard-to-handle&nbsp;<span class="inlinecode"><span class="id" title="tactic">fold</span></span>&nbsp;function&nbsp;*)</span><br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="MMaps.demo.html#fold_add"><span class="id" title="lemma">ZMF.fold_add</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Concerning&nbsp;<span class="inlinecode"><span class="id" title="var">compare</span></span>,&nbsp;we&nbsp;need&nbsp;a&nbsp;ternary&nbsp;decidable&nbsp;comparison<br/>
&nbsp;over&nbsp;datas.&nbsp;We&nbsp;hence&nbsp;diverge&nbsp;slightly&nbsp;apart&nbsp;from&nbsp;Ocaml,&nbsp;by&nbsp;placing<br/>
&nbsp;this&nbsp;<span class="inlinecode"><span class="id" title="var">compare</span></span>&nbsp;in&nbsp;a&nbsp;separate&nbsp;functor&nbsp;requiring&nbsp;2&nbsp;<span class="inlinecode"><span class="id" title="var">OrderedType</span></span>,<br/>
&nbsp;one&nbsp;for&nbsp;the&nbsp;keys&nbsp;and&nbsp;one&nbsp;for&nbsp;the&nbsp;datas,&nbsp;see&nbsp;Interface.Sord<br/>
&nbsp;and&nbsp;for&nbsp;instance&nbsp;RBT.Make_ord&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
<a id="lab148"></a><h2 class="section">The Weak Maps</h2>

</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;Sometimes,&nbsp;one&nbsp;may&nbsp;need&nbsp;finite&nbsp;sets&nbsp;and&nbsp;maps&nbsp;over&nbsp;a&nbsp;base&nbsp;type<br/>
&nbsp;&nbsp;&nbsp;that&nbsp;does&nbsp;not&nbsp;come&nbsp;with&nbsp;a&nbsp;decidable&nbsp;order.&nbsp;As&nbsp;long&nbsp;as&nbsp;this&nbsp;type<br/>
&nbsp;&nbsp;&nbsp;can&nbsp;still&nbsp;be&nbsp;equipped&nbsp;with&nbsp;a&nbsp;decidable&nbsp;equality,&nbsp;the&nbsp;weak<br/>
&nbsp;&nbsp;&nbsp;interface&nbsp;<span class="inlinecode"><span class="id" title="var">Interface.WS</span></span>&nbsp;and&nbsp;its&nbsp;implementation&nbsp;<span class="inlinecode"><span class="id" title="var">MMaps.WeakList</span></span><br/>
&nbsp;&nbsp;&nbsp;provide&nbsp;such&nbsp;structures.<br/>
*)</span><br/>

<br/>
<span class="id" title="keyword">Module</span> <a id="W" class="idref" href="#W"><span class="id" title="module">W</span></a> := <a class="idref" href="MMaps.WeakList.html#Make"><span class="id" title="module">MMaps.WeakList.Make</span></a>(<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z"><span class="id" title="module">BinInt.Z</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Of&nbsp;course,&nbsp;we&nbsp;cannot&nbsp;provide&nbsp;efficient&nbsp;functions&nbsp;anymore&nbsp;:&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;underlying&nbsp;structure&nbsp;is&nbsp;unsorted&nbsp;lists&nbsp;(but&nbsp;without&nbsp;redundancies).&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Compute</span> <a class="idref" href="MMaps.demo.html#bindings"><span class="id" title="definition">W.bindings</span></a> (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">W.add</span></a> 1 "yes" (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">W.add</span></a> 3 "no" (<a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">W.add</span></a> 2 "foo" <a class="idref" href="MMaps.demo.html#empty"><span class="id" title="definition">W.empty</span></a>))).<br/>

<br/>
<span class="comment">(*&nbsp;For&nbsp;now,&nbsp;<span class="inlinecode"><span class="id" title="var">Interface.WS</span></span>&nbsp;provides&nbsp;the&nbsp;same&nbsp;operations&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Interface.S</span></span><br/>
&nbsp;&nbsp;&nbsp;(minus&nbsp;<span class="inlinecode"><span class="id" title="var">compare</span></span>),&nbsp;and&nbsp;the&nbsp;only&nbsp;different&nbsp;specification&nbsp;concerns&nbsp;<span class="inlinecode"><span class="id" title="var">bindings</span></span>,<br/>
&nbsp;&nbsp;&nbsp;which&nbsp;isn't&nbsp;sorted,&nbsp;but&nbsp;only&nbsp;without&nbsp;redundancies.&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Prove&nbsp;properties&nbsp;using&nbsp;general&nbsp;facts&nbsp;relating&nbsp;fold&nbsp;and&nbsp;add&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="addup_table" class="idref" href="#addup_table"><span class="id" title="definition">addup_table</span></a> <a id="tab:20" class="idref" href="#tab:20"><span class="id" title="binder">tab</span></a> :=<br/>
&nbsp;<a class="idref" href="MMaps.demo.html#fold"><span class="id" title="definition">ZM.fold</span></a> (<span class="id" title="keyword">fun</span> <a id="k:21" class="idref" href="#k:21"><span class="id" title="binder">k</span></a> <a id="p:22" class="idref" href="#p:22"><span class="id" title="binder">p</span></a> <a id="i:23" class="idref" href="#i:23"><span class="id" title="binder">i</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.add"><span class="id" title="definition">Z.add</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.pos"><span class="id" title="abbreviation">Z.pos</span></a> <a class="idref" href="MMaps.demo.html#p:22"><span class="id" title="variable">p</span></a>) <a class="idref" href="MMaps.demo.html#i:23"><span class="id" title="variable">i</span></a>) <a class="idref" href="MMaps.demo.html#tab:20"><span class="id" title="variable">tab</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z0"><span class="id" title="constructor">Z0</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="add_to_table" class="idref" href="#add_to_table"><span class="id" title="definition">add_to_table</span></a> <a id="k:24" class="idref" href="#k:24"><span class="id" title="binder">k</span></a> <a id="p:25" class="idref" href="#p:25"><span class="id" title="binder">p</span></a> <a id="tab:26" class="idref" href="#tab:26"><span class="id" title="binder">tab</span></a> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MMaps.demo.html#find"><span class="id" title="definition">ZM.find</span></a> <a class="idref" href="MMaps.demo.html#k:24"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.demo.html#tab:26"><span class="id" title="variable">tab</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x</span> ⇒ <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> <a class="idref" href="MMaps.demo.html#k:24"><span class="id" title="variable">k</span></a> (<a class="idref" href="MMaps.demo.html#p:25"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.BinPos.html#50efadf7a9f9d41adb2b162cbba3bda7"><span class="id" title="notation">+</span></a><span class="id" title="var">x</span>)%<span class="id" title="var">positive</span> <a class="idref" href="MMaps.demo.html#tab:26"><span class="id" title="variable">tab</span></a><br/>
&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="MMaps.demo.html#add"><span class="id" title="definition">ZM.add</span></a> <a class="idref" href="MMaps.demo.html#k:24"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.demo.html#p:25"><span class="id" title="variable">p</span></a> <a class="idref" href="MMaps.demo.html#tab:26"><span class="id" title="variable">tab</span></a><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_from_table" class="idref" href="#get_from_table"><span class="id" title="definition">get_from_table</span></a> <a id="k:27" class="idref" href="#k:27"><span class="id" title="binder">k</span></a> <a id="tab:28" class="idref" href="#tab:28"><span class="id" title="binder">tab</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="MMaps.demo.html#find"><span class="id" title="definition">ZM.find</span></a> <a class="idref" href="MMaps.demo.html#k:27"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.demo.html#tab:28"><span class="id" title="variable">tab</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.pos"><span class="id" title="abbreviation">Z.pos</span></a> <span class="id" title="var">x</span><br/>
&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ 0<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="add_to_table_correct" class="idref" href="#add_to_table_correct"><span class="id" title="lemma">add_to_table_correct</span></a>:<br/>
&nbsp;<span class="id" title="keyword">∀</span> <a id="k:29" class="idref" href="#k:29"><span class="id" title="binder">k</span></a> <a id="p:30" class="idref" href="#p:30"><span class="id" title="binder">p</span></a> <a id="tab:31" class="idref" href="#tab:31"><span class="id" title="binder">tab</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="MMaps.demo.html#addup_table"><span class="id" title="definition">addup_table</span></a> (<a class="idref" href="MMaps.demo.html#add_to_table"><span class="id" title="definition">add_to_table</span></a> <a class="idref" href="MMaps.demo.html#k:29"><span class="id" title="variable">k</span></a> <a class="idref" href="MMaps.demo.html#p:30"><span class="id" title="variable">p</span></a> <a class="idref" href="MMaps.demo.html#tab:31"><span class="id" title="variable">tab</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.add"><span class="id" title="definition">Z.add</span></a> (<a class="idref" href="MMaps.demo.html#addup_table"><span class="id" title="definition">addup_table</span></a> <a class="idref" href="MMaps.demo.html#tab:31"><span class="id" title="variable">tab</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.pos"><span class="id" title="abbreviation">Z.pos</span></a> <a class="idref" href="MMaps.demo.html#p:30"><span class="id" title="variable">p</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="id" title="tactic">intros</span>.<br/>
<span class="id" title="tactic">pose</span> (<span class="id" title="var">lift</span> (<a id="k:32" class="idref" href="#k:32"><span class="id" title="binder"><span id="k:34" class="id">k</span></span></a>: <a class="idref" href="MMaps.demo.html#key"><span class="id" title="definition">ZM.key</span></a>) <a id="p:33" class="idref" href="#p:33"><span class="id" title="binder"><span id="p:35" class="id">p</span></span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.pos"><span class="id" title="abbreviation">Z.pos</span></a> <a class="idref" href="MMaps.demo.html#p:33"><span class="id" title="variable">p</span></a>).<br/>
<span class="id" title="tactic">unfold</span> <a class="idref" href="MMaps.demo.html#addup_table"><span class="id" title="definition">addup_table</span></a>, <a class="idref" href="MMaps.demo.html#add_to_table"><span class="id" title="definition">add_to_table</span></a>.<br/>
<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> @<a class="idref" href="MMaps.demo.html#relate_fold_add"><span class="id" title="lemma">ZMF.relate_fold_add</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#positive"><span class="id" title="inductive">positive</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.eq_equiv"><span class="id" title="axiom">Z.eq_equiv</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="i:36" class="idref" href="#i:36"><span class="id" title="binder"><span id="i:39" class="id">i</span></span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.pos"><span class="id" title="abbreviation">Z.pos</span></a> <a class="idref" href="MMaps.demo.html#i:36"><span class="id" title="variable">i</span></a>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.add"><span class="id" title="definition">Z.add</span></a>)  <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">Lia.lia</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">Lia.lia</span>) <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">Lia.lia</span>)<br/>
&nbsp;&nbsp;&nbsp;0 <span class="id" title="keyword">ltac</span>:(<span class="id" title="var">Lia.lia</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <a id="p:37" class="idref" href="#p:37"><span class="id" title="binder"><span id="p:40" class="id">p</span></span></a> <a id="i:38" class="idref" href="#i:38"><span class="id" title="binder"><span id="i:41" class="id">i</span></span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.OrdersEx.html#Z_as_DT.pos"><span class="id" title="abbreviation">Z_as_DT.pos</span></a> <a class="idref" href="MMaps.demo.html#p:37"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="MMaps.demo.html#i:38"><span class="id" title="variable">i</span></a>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="tactic">reflexivity</span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">tab</span> <span class="id" title="var">k</span>.<br/>
<span class="id" title="tactic">cbv</span> <span class="id" title="keyword">beta</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="tactic">set</span> (<span class="id" title="var">g</span> := <span class="id" title="keyword">fun</span> (<span class="id" title="var">_</span> : <a class="idref" href="MMaps.demo.html#key"><span class="id" title="definition">ZM.key</span></a>) (<a id="p0:42" class="idref" href="#p0:42"><span class="id" title="binder"><span id="p0:44" class="id">p0</span></span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#positive"><span class="id" title="inductive">positive</span></a>) (<a id="i:43" class="idref" href="#i:43"><span class="id" title="binder"><span id="i:45" class="id">i</span></span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>) ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.Structures.OrdersEx.html#Z_as_DT.pos"><span class="id" title="abbreviation">Z_as_DT.pos</span></a> <a class="idref" href="MMaps.demo.html#p0:42"><span class="id" title="variable">p0</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="MMaps.demo.html#i:43"><span class="id" title="variable">i</span></a>) <span class="id" title="tactic">in</span> ×.<br/>
<span class="id" title="tactic">clear</span> <span class="id" title="var">lift</span>.<br/>
<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span> <span class="id" title="var">p</span>).<br/>
<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.ZArith.BinInt.html#Z.add_comm"><span class="id" title="lemma">Z.add_comm</span></a>.<br/>
<span class="id" title="tactic">destruct</span> (<a class="idref" href="MMaps.demo.html#find"><span class="id" title="definition">ZM.find</span></a> <span class="id" title="var">k</span> <span class="id" title="var">tab</span>) <span class="id" title="var">eqn</span>:?<span class="id" title="var">H</span>.<br/>
<span class="id" title="var">erewrite</span> (<span class="id" title="var">H</span> (<span class="id" title="var">p</span><a class="idref" href="http://coq.inria.fr/doc/V8.21+alpha/stdlib//Coq.PArith.BinPos.html#50efadf7a9f9d41adb2b162cbba3bda7"><span class="id" title="notation">+</span></a><span class="id" title="var">p0</span>)%<span class="id" title="var">positive</span>). <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">H</span> <span class="id" title="var">p</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr">coqdoc</a> and improved with <a href="https://github.com/palmskog/coqdocjs">CoqdocJS</a> as adapted for <a href="https://github.com/coq-community">coq-community</a>
</div>
</div>
</body>

</html>
